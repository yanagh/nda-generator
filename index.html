<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DraftPro - Professional Document Generator</title>

  <!-- Load required libraries -->
  <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* your original CSS unchanged */
    :root { --primary:#4361ee; --primary-gradient:linear-gradient(135deg,#4361ee 0%,#3a0ca3 100%); --secondary:#3a0ca3; --accent:#f72585; --light:#f8f9fa; --dark:#212529; --gray:#6c757d; --light-gray:#e9ecef; --success:#4cc9f0; --card-shadow:0 10px 25px rgba(0,0,0,.1); --hover-shadow:0 15px 35px rgba(0,0,0,.15) }
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
    body{background-color:#fafbfd;color:var(--dark);line-height:1.6}
    .container{width:100%;max-width:1200px;margin:0 auto;padding:0 20px}
    header{background:#fff;box-shadow:0 2px 15px rgba(0,0,0,.08);position:fixed;width:100%;top:0;z-index:1000}
    nav{display:flex;justify-content:space-between;align-items:center;padding:20px 0}
    .logo{font-size:1.8rem;font-weight:800;background:var(--primary-gradient);-webkit-background-clip:text;background-clip:text;color:transparent;display:flex;align-items:center;gap:10px}
    .logo i{font-size:2rem}
    .nav-links{display:flex;list-style:none;gap:30px}
    .nav-links a{text-decoration:none;color:var(--dark);font-weight:500;transition:color .3s;position:relative}
    .nav-links a:after{content:'';position:absolute;bottom:-5px;left:0;width:0;height:3px;background:var(--primary-gradient);border-radius:3px;transition:width .3s}
    .nav-links a:hover{color:var(--primary)} .nav-links a:hover:after{width:100%}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:12px 28px;background:var(--primary-gradient);color:#fff;border-radius:50px;text-decoration:none;font-weight:600;transition:all .3s;border:none;cursor:pointer;box-shadow:0 4px 15px rgba(67,97,238,.3)}
    .btn:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(67,97,238,.4)}
    .hero{padding:160px 0 100px;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);position:relative;overflow:hidden}
    .hero-content{max-width:650px;z-index:2;position:relative}
    .hero h1{font-size:3.2rem;margin-bottom:20px;color:var(--dark);line-height:1.2;font-weight:800}
    .hero p{font-size:1.25rem;margin-bottom:30px;color:var(--gray)}
    .hero-buttons{display:flex;gap:15px;flex-wrap:wrap}
    .btn-outline{background:transparent;border:2px solid var(--primary);color:var(--primary);box-shadow:none}
    .btn-outline:hover{background:var(--primary);color:#fff}
    .templates-section{padding:80px 0;background:#fff}
    .section-title{text-align:center;margin-bottom:50px}
    .section-title h2{font-size:2.5rem;color:var(--dark);margin-bottom:15px;font-weight:700}
    .section-title p{color:var(--gray);max-width:600px;margin:0 auto;font-size:1.1rem}
    .templates-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin-top:40px}
    .template-card{background:#fff;border-radius:16px;padding:30px;box-shadow:var(--card-shadow);transition:all .3s ease;border:1px solid var(--light-gray);text-align:center;cursor:pointer;position:relative;overflow:hidden}
    .template-card:before{content:'';position:absolute;top:0;left:0;width:5px;height:100%;background:var(--primary-gradient);opacity:0;transition:opacity .3s}
    .template-card:hover{transform:translateY(-10px);box-shadow:var(--hover-shadow)}
    .template-card:hover:before{opacity:1}
    .template-icon{width:70px;height:70px;background:linear-gradient(135deg,rgba(67,97,238,.1) 0%,rgba(58,12,163,.1) 100%);border-radius:16px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:28px;color:var(--primary)}
    .template-card h3{font-size:1.5rem;margin-bottom:15px;color:var(--dark)}
    .template-card p{color:var(--gray);margin-bottom:20px}
    .form-section{padding:80px 0;background:var(--light);display:none}
    .form-section.active{display:block}
    .form-container{background:#fff;border-radius:20px;box-shadow:var(--card-shadow);padding:40px;max-width:800px;margin:0 auto}
    .form-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px}
    .form-header h3{font-size:1.8rem;color:var(--dark)}
    .back-to-templates{display:flex;align-items:center;gap:8px;color:var(--primary);text-decoration:none;font-weight:500}
    .form-group{margin-bottom:25px}
    .form-group label{display:block;margin-bottom:8px;font-weight:500;color:var(--dark)}
    .form-group input,.form-group textarea{width:100%;padding:15px;border:1px solid var(--light-gray);border-radius:10px;font-size:1rem;transition:all .3s}
    .form-group input:focus,.form-group textarea:focus{border-color:var(--primary);outline:none;box-shadow:0 0 0 3px rgba(67,97,238,.1)}
    .form-row{display:flex;gap:20px}
    .form-row .form-group{flex:1}
    .submit-btn{text-align:center;margin-top:30px}
    .features{padding:80px 0;background:#fff}
    .features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin-top:50px}
    .feature-card{background:#fff;border-radius:16px;padding:30px;box-shadow:var(--card-shadow);transition:transform .3s;text-align:center}
    .feature-card:hover{transform:translateY(-5px)}
    .feature-icon{width:60px;height:60px;background:linear-gradient(135deg,rgba(67,97,238,.1) 0%,rgba(58,12,163,.1) 100%);border-radius:16px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:24px;color:var(--primary)}
    .feature-card h3{font-size:1.5rem;margin-bottom:15px;color:var(--dark)}
    footer{background:var(--dark);color:#fff;padding:60px 0 30px}
    .footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:40px;margin-bottom:40px}
    .footer-column h3{font-size:1.2rem;margin-bottom:20px;color:#fff}
    .footer-column ul{list-style:none}
    .footer-column ul li{margin-bottom:10px}
    .footer-column a{color:#aaa;text-decoration:none;transition:color .3s}
    .footer-column a:hover{color:#fff}
    .copyright{text-align:center;padding-top:30px;border-top:1px solid #444;color:#aaa}
    @media (max-width:768px){.hero h1{font-size:2.5rem}.form-row{flex-direction:column;gap:0}.nav-links{display:none}.hero-buttons{flex-direction:column}}
    .loading{display:none;text-align:center;margin-top:20px}
    .loading i{font-size:2rem;color:var(--primary);animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <!-- your original HTML content (header, hero, templates, forms, features, footer) exactly as you posted -->
  <!-- ... (unchanged markup from your message goes here) ... -->

  <!-- Single, correct script block -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const { Document, Packer, Paragraph, HeadingLevel, AlignmentType, TextRun } = docx;

      // Helpers
      function setDefaultDates() {
        document.querySelectorAll('input[type="date"]').forEach(input => {
          if (!input.id.includes('endDate')) input.valueAsDate = new Date();
        });
        const meetingTimeInput = document.getElementById('meetingTime');
        if (meetingTimeInput && !meetingTimeInput.value) meetingTimeInput.value = "10:00";

        const endDateInput = document.getElementById('endDate');
        if (endDateInput && !endDateInput.valueAsDate) {
          const end = new Date();
          end.setDate(end.getDate() + 30);
          endDateInput.valueAsDate = end;
        }
      }

      async function generateDocx(sections, filename) {
        try {
          const doc = new Document({ sections });
          const blob = await Packer.toBlob(doc); // Browser-safe
          saveAs(blob, filename);
        } catch (err) {
          console.error('Error generating document:', err);
          alert('An error occurred while generating the document. Please try again.');
        }
      }

      // Template selection toggle
      document.querySelectorAll('.template-card').forEach(card => {
        card.addEventListener('click', () => {
          const templateType = card.getAttribute('data-template'); // nda | service | meeting
          document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
          const formSection = document.getElementById(`${templateType}-form`);
          if (formSection) {
            formSection.classList.add('active');
            window.scrollTo({ top: formSection.offsetTop - 100, behavior: 'smooth' });
          }
        });
      });

      // Back to templates
      document.querySelectorAll('.back-to-templates').forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
          const templatesSection = document.getElementById('templates');
          if (templatesSection) {
            window.scrollTo({ top: templatesSection.offsetTop - 100, behavior: 'smooth' });
          }
        });
      });

      // --- Form handlers ---

      // NDA
      const ndaForm = document.getElementById('ndaForm');
      if (ndaForm) {
        ndaForm.addEventListener('submit', async e => {
          e.preventDefault();
          const loading = document.getElementById('ndaLoading');
          if (loading) loading.style.display = 'block';

          const yourName = document.getElementById('yourName').value;
          const yourPassport = document.getElementById('yourPassport').value;
          const companyName = document.getElementById('companyName').value;
          const counterpartyName = document.getElementById('counterpartyName').value;
          const counterpartyPassport = document.getElementById('counterpartyPassport').value;
          const effectiveDate = document.getElementById('effectiveDate').value;
          const purpose = document.getElementById('purpose').value;
          const currentDate = new Date().toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });

          const sections = [{
            children: [
              new Paragraph({ text: "NON-DISCLOSURE AGREEMENT", heading: HeadingLevel.HEADING_1, alignment: AlignmentType.CENTER }),
              new Paragraph({ text: `Effective Date: ${effectiveDate}` }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun("This Non-Disclosure Agreement (the “Agreement”) is made and entered into as of the Effective Date by and between:") ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("Disclosing Party:"),
                new TextRun({ text: `\n\nName: ${yourName}`, bold: true }),
                new TextRun({ text: `\nCompany: ${companyName}`, bold: true }),
                new TextRun({ text: `\nPassport Number: ${yourPassport}`, bold: true }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("Receiving Party:"),
                new TextRun({ text: `\n\nName: ${counterpartyName}`, bold: true }),
                new TextRun({ text: `\nPassport Number: ${counterpartyPassport}`, bold: true }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("1. Purpose:"),
                new TextRun({ text: `\n\nThe purpose of this Agreement is to protect Confidential Information disclosed by the Disclosing Party to the Receiving Party for the purpose of ${purpose}.` }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("2. Confidential Information:"),
                new TextRun({ text: `\n\n“Confidential Information” means any and all information, whether written or oral, concerning the Disclosing Party's business, finances, products, services, customers, and intellectual property.` }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun("IN WITNESS WHEREOF, the parties have executed this Agreement as of the date first above written.") ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ text: `________________________\nDisclosing Party Signature\n\nDate: ${currentDate}` }),
              new Paragraph({ text: `\n\n________________________\nReceiving Party Signature\n\nDate: ${currentDate}` }),
            ]
          }];

          await generateDocx(sections, "Non-Disclosure_Agreement.docx");
          if (loading) loading.style.display = 'none';
        });
      }

      // Service Agreement
      const serviceForm = document.getElementById('serviceForm');
      if (serviceForm) {
        serviceForm.addEventListener('submit', async e => {
          e.preventDefault();
          const loading = document.getElementById('serviceLoading');
          if (loading) loading.style.display = 'block';

          const providerName = document.getElementById('providerName').value;
          const clientName = document.getElementById('clientName').value;
          const serviceDescription = document.getElementById('serviceDescription').value;
          const serviceFee = document.getElementById('serviceFee').value;
          const startDate = document.getElementById('startDate').value;
          const endDate = document.getElementById('endDate').value;
          const paymentTerms = document.getElementById('paymentTerms').value;

          const sections = [{
            children: [
              new Paragraph({ text: "SERVICE AGREEMENT", heading: HeadingLevel.HEADING_1, alignment: AlignmentType.CENTER }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("This Service Agreement (the “Agreement”) is made as of "),
                new TextRun({ text: new Date(startDate).toLocaleDateString(), bold: true }),
                new TextRun(", by and between "),
                new TextRun({ text: providerName, bold: true }),
                new TextRun(" (the “Service Provider”) and "),
                new TextRun({ text: clientName, bold: true }),
                new TextRun(" (the “Client”).")
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("1. Services:"),
                new TextRun({ text: `\n\nService Provider agrees to provide the following services to the Client: ${serviceDescription}.` }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("2. Term:"),
                new TextRun({ text: `\n\nThe term of this Agreement shall commence on ${new Date(startDate).toLocaleDateString()} and shall continue until ${new Date(endDate).toLocaleDateString()}, unless terminated earlier in accordance with this Agreement.` }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [
                new TextRun("3. Compensation:"),
                new TextRun({ text: `\n\nClient agrees to pay the Service Provider a fee of $${serviceFee}. The payment terms are as follows: ${paymentTerms}.` }),
              ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun("IN WITNESS WHEREOF, the parties have executed this Agreement.") ] }),
              new Paragraph({ text: `\n\n________________________\nService Provider Signature\n\n________________________\nClient Signature` }),
            ]
          }];

          await generateDocx(sections, "Service_Agreement.docx");
          if (loading) loading.style.display = 'none';
        });
      }

      // Meeting Protocol
      const meetingForm = document.getElementById('meetingForm');
      if (meetingForm) {
        meetingForm.addEventListener('submit', async e => {
          e.preventDefault();
          const loading = document.getElementById('meetingLoading');
          if (loading) loading.style.display = 'block';

          const meetingTitle = document.getElementById('meetingTitle').value;
          const meetingDate = document.getElementById('meetingDate').value;
          const meetingTime = document.getElementById('meetingTime').value;
          const attendees = document.getElementById('attendees').value.split(',').map(s => s.trim()).filter(Boolean);
          const meetingAgenda = document.getElementById('meetingAgenda').value.split('\n').map(s => s.trim()).filter(Boolean);
          const decisions = document.getElementById('decisions').value.split('\n').map(s => s.trim()).filter(Boolean);
          const actionItems = document.getElementById('actionItems').value.split('\n').map(s => s.trim()).filter(Boolean);

          const sections = [{
            children: [
              new Paragraph({ text: `MEETING PROTOCOL: ${meetingTitle.toUpperCase()}`, heading: HeadingLevel.HEADING_1, alignment: AlignmentType.CENTER }),
              new Paragraph({ text: "" }),
              new Paragraph({ text: `Date: ${new Date(meetingDate).toLocaleDateString()}` }),
              new Paragraph({ text: `Time: ${meetingTime}` }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun({ text: "Attendees:", bold: true }), ...attendees.map(n => new TextRun({ text: `\n• ${n}` })) ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun({ text: "Agenda:", bold: true }), ...meetingAgenda.map(i => new TextRun({ text: `\n• ${i}` })) ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun({ text: "Key Decisions:", bold: true }), ...decisions.map(i => new TextRun({ text: `\n• ${i}` })) ] }),
              new Paragraph({ text: "" }),
              new Paragraph({ children: [ new TextRun({ text: "Action Items:", bold: true }), ...actionItems.map(i => new TextRun({ text: `\n• ${i}` })) ] }),
            ]
          }];

          await generateDocx(sections, "Meeting_Protocol.docx");
          if (loading) loading.style.display = 'none';
        });
      }

      // Initialize defaults on ready
      setDefaultDates();
    });
  </script>
</body>
</html>
